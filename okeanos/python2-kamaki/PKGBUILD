# Maintainer: Axilleas P <axilleas@archlinux.gr>

pkgname=python2-kamaki-git
pkgver=20120604
pkgrel=1
pkgdesc="A command-line tool for managing clouds."
arch=(any)
url="http://code.grnet.gr/projects/kamaki"
license=('BSD')
depends=('python2-ansicolors=1.0.2' 'python2-progress=1.0.1' 'python2-requests=0.12.1' 'python2-oauthlib' 'python2-certifi')
makedepends=('git' 'python2' 'python2-distribute')

_gitroot="https://code.grnet.gr/git/kamaki"
_gitname="kamaki"

build() {

  cd "$srcdir"
  	msg "Connecting to GIT server...."

  if [[ -d $srcdir/$_gitname ]] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot $_gitname
  fi

	msg "GIT checkout done"
	msg "Starting make..."

	git clone $srcdir/$_gitname $srcdir/$_gitname-build

	#fix python2 issues
	cd $srcdir/$_gitname-build/$_gitname
	sed -i 's|#!/usr/bin/env python|#!/usr/bin/env python2|' *.py 
	
	cd $srcdir/$_gitname-build/
	python2 setup.py install --root="${pkgdir}" -O1
} 
